<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Firebase Cloud Functions — Como começar?</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Firebase Cloud Functions — Como começar?</h1>
</header>
<section data-field="subtitle" class="p-summary">
Aprenda a utilizar o Firebase Cloud Functions
</section>
<section data-field="description" class="p-summary">
Este artigo é parte da série Firebase Cloud Functions.
</section>
<section data-field="body" class="e-content">
<section name="165a" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><figure name="3fff" id="3fff" class="graf graf--figure graf--leading"><img class="graf-image" data-image-id="1*lDJxCk5HD2OL7BGKJFhlcg.png" data-width="1043" data-height="313" src="https://cdn-images-1.medium.com/max/800/1*lDJxCk5HD2OL7BGKJFhlcg.png"></figure><h3 name="a910" id="a910" class="graf graf--h3 graf-after--figure graf--title">Firebase Cloud Functions — Como começar?</h3><p name="a772" id="a772" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">Este artigo é parte da série Firebase Cloud Functions:</strong></p><ol class="postList"><li name="aebc" id="aebc" class="graf graf--li graf-after--p"><a href="https://medium.com/@rosariopfernandes/firebase-cloud-functions-f6ed3787fa8d" data-href="https://medium.com/@rosariopfernandes/firebase-cloud-functions-f6ed3787fa8d" class="markup--anchor markup--li-anchor" target="_blank">O que é Firebase Cloud Functions?</a></li><li name="192b" id="192b" class="graf graf--li graf-after--li">Firebase Cloud Functions — Como começar?</li><li name="8f70" id="8f70" class="graf graf--li graf-after--li"><a href="https://medium.com/@rosariopfernandes/fcf-fcm-d5828e7eab94" data-href="https://medium.com/@rosariopfernandes/fcf-fcm-d5828e7eab94" class="markup--anchor markup--li-anchor" target="_blank">Firebase Cloud Functions + Cloud Messaging</a></li><li name="852d" id="852d" class="graf graf--li graf-after--li"><a href="https://medium.com/@rosariopfernandes/fcf-mantain-c95c520089d9" data-href="https://medium.com/@rosariopfernandes/fcf-mantain-c95c520089d9" class="markup--anchor markup--li-anchor" target="_blank">Firebase Cloud Functions — Limpeza e Manutenção da Realtime Database</a></li><li name="d106" id="d106" class="graf graf--li graf-after--li"><a href="https://medium.com/@rosariopfernandes/48d503a6cd24" data-href="https://medium.com/@rosariopfernandes/48d503a6cd24" class="markup--anchor markup--li-anchor" target="_blank">Firebase Cloud Functions — Chame uma função na sua app</a></li><li name="955c" id="955c" class="graf graf--li graf-after--li graf--trailing"><a href="https://medium.com/android-dev-moz/fcf-search-7fd744b60dee" data-href="https://medium.com/android-dev-moz/fcf-search-7fd744b60dee" class="markup--anchor markup--li-anchor" target="_blank">Firebase Cloud Functions — Pesquisa de Texto na Base de Dados</a></li></ol></div></div></section><section name="5562" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="0dda" id="0dda" class="graf graf--h3 graf--leading">Como começar?</h3><p name="b49a" id="b49a" class="graf graf--p graf-after--h3">Agora que já sabemos <a href="https://medium.com/@rosariopfernandes/firebase-cloud-functions-f6ed3787fa8d" data-href="https://medium.com/@rosariopfernandes/firebase-cloud-functions-f6ed3787fa8d" class="markup--anchor markup--p-anchor" target="_blank">o que é o Cloud Functions</a>, vamos por as mãos nele.</p><p name="b235" id="b235" class="graf graf--p graf-after--p">Primeiramente, para utilizar o Firebase Cloud Functions temos de ter o <a href="https://firebase.google.com/docs/cli/" data-href="https://firebase.google.com/docs/cli/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Firebase CLI (Command-Line Interface)</a> instalado no nosso computador. Mas o CLI requere que tenhamos o <a href="https://nodejs.org/" data-href="https://nodejs.org/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">NodeJS</a> (versão 6.3.1 ou superior) e <a href="https://npmjs.org/" data-href="https://npmjs.org/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">npm</a> instalados. Ao <a href="https://nodejs.org/en/download/" data-href="https://nodejs.org/en/download/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">instalar o NodeJS</a>, o npm é instalado automaticamente.</p><p name="6543" id="6543" class="graf graf--p graf-after--p">Só depois de ter isso instalado é que podemos instalar o Firebase CLI. Basta utilizar o comando:</p><pre name="6a0d" id="6a0d" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">npm</strong> <strong class="markup--strong markup--pre-strong">install</strong> -g firebase-tools</code></pre><h4 name="cc99" id="cc99" class="graf graf--h4 graf-after--pre">Inicializar o projecto</h4><p name="6a1f" id="6a1f" class="graf graf--p graf-after--h4">Agora que temos o Firebase CLI, podemos utilizar o comando “<em class="markup--em markup--p-em">firebase</em>” no nosso computador. Vamos então criar o projecto:</p><ol class="postList"><li name="4006" id="4006" class="graf graf--li graf-after--p">Crie um directório (folder) no seu computador e dê o nome do Projecto. Este directório irá conter todos os dados do projecto que depois irão para a consola (hosting e cloud functions basicamente).</li><li name="4cae" id="4cae" class="graf graf--li graf-after--li">Abra esse directório na terminal(Command Prompt no Windows) e execute o comando: <strong class="markup--strong markup--li-strong"><em class="markup--em markup--li-em">firebase login</em></strong><em class="markup--em markup--li-em"><br></em>Esse<em class="markup--em markup--li-em"> </em>comando irá abrir uma aba no seu browser para você entrar na sua conta Google que está conectada com o Firebase. (Para o CLI ter acesso aos seus projectos já existentes)</li><li name="66d1" id="66d1" class="graf graf--li graf-after--li">Depois de estar autenticado, na mesma terminal, execute o comando: <strong class="markup--strong markup--li-strong"><em class="markup--em markup--li-em">firebase init functions</em></strong><em class="markup--em markup--li-em"><br></em>Esse<em class="markup--em markup--li-em"> </em>comando irá criar alguns directórios e ficheiros no directório do seu projecto, incluindo uma pasta com o nome <em class="markup--em markup--li-em">functions</em>, cujo conteudo é mostrado na imagem abaixo:</li></ol><figure name="bd81" id="bd81" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*4b9tHXl2pNskjjjY9veM7g.png" data-width="385" data-height="304" src="https://cdn-images-1.medium.com/max/800/1*4b9tHXl2pNskjjjY9veM7g.png"></figure><h4 name="a0ac" id="a0ac" class="graf graf--h4 graf-after--figure">Nossas primeiras funções</h4><p name="b744" id="b744" class="graf graf--p graf-after--h4">Agora que temos o Firebase CLI instalado, podemos começar a escrever Cloud Functions.</p><p name="d88f" id="d88f" class="graf graf--p graf-after--p">Para começar, vamos utilizar a base de dados criada na série <a href="https://medium.com/android-dev-moz/firebasesql-4ee3d26a3d15" data-href="https://medium.com/android-dev-moz/firebasesql-4ee3d26a3d15" class="markup--anchor markup--p-anchor" target="_blank">Firebase Database para Desenvolvedores SQL</a>. Se você não conhece esta série, aqui vai:</p><div name="0f97" id="0f97" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/android-dev-moz/firebasesql-4ee3d26a3d15" data-href="https://medium.com/android-dev-moz/firebasesql-4ee3d26a3d15" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/android-dev-moz/firebasesql-4ee3d26a3d15"><strong class="markup--strong markup--mixtapeEmbed-strong">Firebase Database para Desenvolvedores SQL — O Básico</strong><br><em class="markup--em markup--mixtapeEmbed-em">Uma série para desenvolvedores SQL poderem começar a utilizar o Firebase.</em>medium.com</a><a href="https://medium.com/android-dev-moz/firebasesql-4ee3d26a3d15" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="a16572f075314dc5f94221f99ef291cc" data-thumbnail-img-id="1*7LGa4E_G7zfPG9hup9HF3g.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*7LGa4E_G7zfPG9hup9HF3g.png);"></a></div><p name="c853" id="c853" class="graf graf--p graf-after--mixtapeEmbed">A aplicação desenvolvida na série permitia que estudantes (nossos utilizadores) participassem de grupos de estudos. Vamos então utilizar o Cloud Functions para contar o número de grupos em que um estudante está a participar.</p><p name="b0be" id="b0be" class="graf graf--p graf-after--p">Na nossa base de dados tinhamos algo mais ou menos assim:</p><figure name="c027" id="c027" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*DhrSx9hnFDHIS7q2JLWuVg.png" data-width="244" data-height="165" src="https://cdn-images-1.medium.com/max/800/1*DhrSx9hnFDHIS7q2JLWuVg.png"><figcaption class="imageCaption">Estrutura para conhecermos os grupos em que cada participante está</figcaption></figure><p name="a29e" id="a29e" class="graf graf--p graf-after--figure">Para contar o número de grupos, vamos alterar um bocado a estructura actual. Temos de adicionar um nó que irá guardar o número de grupos de cada usuário:</p><figure name="6f67" id="6f67" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*jsFqoSs_DtvaLR2v6TN3DA.png" data-width="383" data-height="399" src="https://cdn-images-1.medium.com/max/800/1*jsFqoSs_DtvaLR2v6TN3DA.png"></figure><p name="3436" id="3436" class="graf graf--p graf-after--figure">Então temos de criar 2 funções:</p><ul class="postList"><li name="c500" id="c500" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">contarGrupos</strong> — para incrementar o contador quando o estudante se junta à um novo grupo ou decrementar quando o estudante sai de um grupo;</li><li name="1504" id="1504" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">recontarGrupos</strong> — para contar o número de grupos caso o contador seja apagado.</li></ul><p name="1f5a" id="1f5a" class="graf graf--p graf-after--li">Todas as funções são escritas no ficheiro <em class="markup--em markup--p-em">index.js</em> que está na pasta functions. Então abra o ficheiro e você encontrará a variável do functions já declarada e alguns comentários. Você pode alterar essa variável para que seja constante e em seguida inicializar o Firebase Cloud Functions, utilizando o código:</p><pre name="fc0a" id="fc0a" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">const</strong> functions = <strong class="markup--strong markup--pre-strong">require</strong>(‘<em class="markup--em markup--pre-em">firebase-functions</em>’); //Constante para invocar o Firebase Cloud Functions<br><strong class="markup--strong markup--pre-strong">const</strong> admin = <strong class="markup--strong markup--pre-strong">require</strong>(‘<em class="markup--em markup--pre-em">firebase-admin</em>’); //Constante para invocar o Firebase Admin SDK<br>admin.<strong class="markup--strong markup--pre-strong">initializeApp</strong>(functions.config().firebase); //Inicializar o Firebase com configurações do functions</pre><p name="bf42" id="bf42" class="graf graf--p graf-after--pre">Para criar uma Cloud Function, basta usarmos <em class="markup--em markup--p-em">exports.nomeDaFuncao</em> e indicar o evento que dispara a função:</p><pre name="d584" id="d584" class="graf graf--pre graf-after--p">exports.contarGrupos = functions.database.ref(“/usuarios_grupos/{uid}/grupos/{grupoid}”).onWrite((event) =&gt; {<br> //O evento é disparado quando há uma nova escrita no nó especificado<br>});</pre><p name="0611" id="0611" class="graf graf--p graf-after--pre">O corpo da nossa função seria o seguinte:</p><pre name="e38b" id="e38b" class="graf graf--pre graf-after--p">//O que acontece quando há uma nova escrita no nó especificado<br> var gruposRef = event.data.ref.parent; //Obter a referencia dos grupos<br> var contadorRef = gruposRef.parent.child(‘nr_grupos’); //Obter a referencia do contador</pre><pre name="d8e4" id="d8e4" class="graf graf--pre graf-after--pre">return contadorRef.transaction(function(current) { //Esta função retorna uma transaction<br> if (event.data.exists() &amp;&amp; !event.data.previous.exists()) {<br> return (current || 0) + 1;//Adicionar um<br> }<br> else if (!event.data.exists() &amp;&amp; event.data.previous.exists()) {<br> return (current || 0) — 1;//Subtrair um<br> }<br> });</pre><p name="462b" id="462b" class="graf graf--p graf-after--pre">E a seguinte função seria:</p><pre name="bab5" id="bab5" class="graf graf--pre graf-after--p">exports.recontarGrupos = functions.database.ref(“/usuarios_grupos/{uid}/nr_grupos”).onWrite((event) =&gt; {<br> if (!event.data.exists()) {<br> //Se o numero de grupos for removido, recontar<br> var contadorRef = event.data.ref;<br> var gruposRef = contadorRef.parent.child(‘grupos’);<br> return gruposRef.once(‘value’, function(grupos) {<br> return contadorRef.set(grupos.numChildren());<br> });<br> }<br>});</pre><p name="2345" id="2345" class="graf graf--p graf-after--pre">O código completo fica assim:</p><figure name="a9e9" id="a9e9" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/rosariopfernandes/a46b835f2fa3e2df3f551a47e7a6f9b9.js.js"></script></figure><p name="6d1c" id="6d1c" class="graf graf--p graf-after--figure">Depois de terminarmos as nossas funções, basta fazermos o deploy delas para o Firebase. Para isso, usamos o comando:</p><pre name="8368" id="8368" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">firebase</strong> <strong class="markup--strong markup--pre-strong">deploy</strong> --only functions</code></pre><p name="e784" id="e784" class="graf graf--p graf-after--pre">E já está. Depois do processo de deploy terminar, já teremos as nossas <a href="https://console.firebase.google.com/project/_/functions/list" data-href="https://console.firebase.google.com/project/_/functions/list" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">funções na consola</a>. Você pode experimentar adicionar um novo grupo no nó “grupos” de um estudante e verá o contador a incrementar. :)</p><p name="6c3e" id="6c3e" class="graf graf--p graf-after--p">No <a href="https://medium.com/@rosariopfernandes/fcf-fcm-d5828e7eab94" data-href="https://medium.com/@rosariopfernandes/fcf-fcm-d5828e7eab94" class="markup--anchor markup--p-anchor" target="_blank">artigo a seguir</a> vemos como enviar notificações à usuários sobre eventos que aconteceram na base de dados, usando o <a href="https://firebase.google.com/docs/cloud-messaging/" data-href="https://firebase.google.com/docs/cloud-messaging/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Firebase Cloud Messaging</a>.</p><div name="5559" id="5559" class="graf graf--mixtapeEmbed graf-after--p graf--trailing"><a href="https://medium.com/android-dev-moz/fcf-fcm-d5828e7eab94" data-href="https://medium.com/android-dev-moz/fcf-fcm-d5828e7eab94" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/android-dev-moz/fcf-fcm-d5828e7eab94"><strong class="markup--strong markup--mixtapeEmbed-strong">Firebase Cloud Functions + Cloud Messaging (FCM)</strong><br><em class="markup--em markup--mixtapeEmbed-em">Saiba como usar o Firebase Cloud Functions em conjunto com o FCM para notificar os utilizadores sobre algo que…</em>medium.com</a><a href="https://medium.com/android-dev-moz/fcf-fcm-d5828e7eab94" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="076eb19f01681c479f65ee99cf35af90" data-thumbnail-img-id="1*lDJxCk5HD2OL7BGKJFhlcg.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*lDJxCk5HD2OL7BGKJFhlcg.png);"></a></div></div></div></section><section name="8e47" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="e434" id="e434" class="graf graf--p graf--leading graf--trailing">Se você tem alguma dúvida ou sugestão, não hesite em me contactar pelo email <a href="mailto:rosariofernandes51@gmail.com" data-href="mailto:rosariofernandes51@gmail.com" class="markup--anchor markup--p-anchor" target="_blank">rosariofernandes51@gmail.com</a> ou pelo <a href="https://telegram.me/rosariopfernandes" data-href="https://telegram.me/rosariopfernandes" class="markup--anchor markup--p-anchor" rel="nofollow noopener nofollow noopener noopener" target="_blank">Telegram</a>. Ficarei feliz por conversar com você. :)</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@thatfire.dev" class="p-author h-card">Rosário Pereira Fernandes</a> on <a href="https://medium.com/p/32c984dbc12"><time class="dt-published" datetime="2017-03-18T06:02:01.226Z">March 18, 2017</time></a>.</p><p><a href="https://medium.com/@thatfire.dev/fcf-comecar-32c984dbc12" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 24, 2025.</p></footer></article></body></html>