<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Android Architecture Componentsâ€Šâ€”â€ŠRoom</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Android Architecture Componentsâ€Šâ€”â€ŠRoom</h1>
</header>
<section data-field="subtitle" class="p-summary">
ConheÃ§a o â€œRoomâ€ da biblioteca Android Architecture Components apresentada no Google I/O 2017
</section>
<section data-field="description" class="p-summary">
Agora que jÃ¡ sabemos fazer os nossos dados reagirem correctamente aos eventos no ciclo de vida de cada activity/fragment, vamos conhecer uma forma simples de persistir estes dados localmente.
</section>
<section data-field="body" class="e-content">
<section name="f8e8" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><figure name="a035" id="a035" class="graf graf--figure graf--leading"><img class="graf-image" data-image-id="1*QgCFnJ7zOy-Wp6HG_F63Hw.png" data-width="1043" data-height="313" src="https://cdn-images-1.medium.com/max/800/1*QgCFnJ7zOy-Wp6HG_F63Hw.png"></figure><h3 name="e37d" id="e37d" class="graf graf--h3 graf-after--figure graf--title">Android Architecture Componentsâ€Šâ€”â€ŠRoom</h3><p name="ff66" id="ff66" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">Este artigo Ã© parte da sÃ©rie Android Architecture Components:</strong></p><ol class="postList"><li name="aebc" id="aebc" class="graf graf--li graf-after--p"><a href="https://medium.com/@rosariopfernandes/aac1-bc22abbabecc" data-href="https://medium.com/@rosariopfernandes/aac1-bc22abbabecc" class="markup--anchor markup--li-anchor" target="_blank">Android Architecture Componentsâ€Šâ€”â€ŠOlÃ¡ Mundo</a></li><li name="8859" id="8859" class="graf graf--li graf-after--li"><a href="https://medium.com/@rosariopfernandes/aac2-a7c59e1a3cf7" data-href="https://medium.com/@rosariopfernandes/aac2-a7c59e1a3cf7" class="markup--anchor markup--li-anchor" target="_blank">Android Architecture Componentsâ€Šâ€”â€ŠLifecycle</a></li><li name="56e8" id="56e8" class="graf graf--li graf-after--li"><a href="https://medium.com/@rosariopfernandes/aac3-1df6cd39b4e0" data-href="https://medium.com/@rosariopfernandes/aac3-1df6cd39b4e0" class="markup--anchor markup--li-anchor" target="_blank">Android Architecture Componentsâ€Šâ€”â€ŠLifecycleOwner</a></li><li name="d28f" id="d28f" class="graf graf--li graf-after--li"><a href="https://medium.com/@rosariopfernandes/aac4-f971fed5d2a3" data-href="https://medium.com/@rosariopfernandes/aac4-f971fed5d2a3" class="markup--anchor markup--li-anchor" target="_blank">Android Architecture Componentsâ€Šâ€”â€ŠViewModel</a></li><li name="1031" id="1031" class="graf graf--li graf-after--li"><a href="https://medium.com/@rosariopfernandes/aac5-9c56e6b4cffc" data-href="https://medium.com/@rosariopfernandes/aac5-9c56e6b4cffc" class="markup--anchor markup--li-anchor" target="_blank">Android Architecture Componentsâ€Šâ€”â€ŠLiveData</a></li><li name="0d37" id="0d37" class="graf graf--li graf-after--li graf--trailing"><a href="https://medium.com/@rosariopfernandes/aac6-b46de8513df8" data-href="https://medium.com/@rosariopfernandes/aac6-b46de8513df8" class="markup--anchor markup--li-anchor" target="_blank">Android Architecture Componentsâ€Šâ€”â€ŠRoom</a></li></ol></div></div></section><section name="c6e9" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="d6e5" id="d6e5" class="graf graf--p graf--leading">Agora que jÃ¡ sabemos fazer os nossos dados reagirem correctamente aos eventos no ciclo de vida de cada activity/fragment, vamos conhecer uma forma simples de persistir estes dados localmente.</p><p name="b781" id="b781" class="graf graf--p graf-after--p">No Android existem 3 formas de persistir dados localmente:</p><p name="c000" id="c000" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">SharedPreferences</strong>â€Šâ€”â€Šarmazena os dados em xml temporariamente. Geralmente utilizado para armazenar as preferÃªncias do utilizador.</p><p name="1409" id="1409" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Ficheiros</strong>â€Šâ€”â€Šarmazena os dados na memÃ³ria do telemÃ³vel ou cartÃ£o de memÃ³ria de modo que possam ser acedidos pelo Gestor de Ficheiros.</p><p name="af49" id="af49" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Base de dados SQLite</strong>â€Šâ€”â€Šuma base de dados estructurada que armazena os dados na memÃ³ria local do telemÃ³vel.</p><p name="57b8" id="57b8" class="graf graf--p graf-after--p">Para quem utilizou este Ãºltimo mÃ©todo sabe o tamanho de cÃ³digo que tem de escrever: criar uma classe que herda de SQLiteHelper, criar queries para criar cada uma das tabelas com a sua devida estructura, criar queries para ler/armazenar os dados, processar os resultados utilizando cursors, apresentar os dados utilizando loaders, etc.</p><p name="0294" id="0294" class="graf graf--p graf-after--p">E Ã© para lhe poupar desse trabalho todo que foi criada a biblioteca Room. Room Ã© uma biblioteca que visa facilitar o uso de base de dados SQLite. Com esta biblioteca vocÃª nÃ£o precisa de utilizar cursors ou loaders. E pode executar queries utilizando apenas anotaÃ§Ãµes na sua classe modelo.</p><p name="7720" id="7720" class="graf graf--p graf-after--p">Para quem jÃ¡ utilizou outras bibliotecas para persistir dados localmente, como o <a href="https://realm.io/" data-href="https://realm.io/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">realm</a> e/ou o <a href="http://satyan.github.io/sugar/index.html" data-href="http://satyan.github.io/sugar/index.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">SugarORM,</a> irÃ¡ se sentir avontade com esta biblioteca pois Ã© bem parecida e a forma de utilizaÃ§Ã£o Ã© praticamente a mesma.</p><h3 name="4b70" id="4b70" class="graf graf--h3 graf-after--p">MÃ£os Ã Â obra</h3><p name="3c2e" id="3c2e" class="graf graf--p graf-after--h3">Para comeÃ§ar, temos de adicionar mais 2 dependencias (alÃ©m das que adicionamos no 1Âº artigo) no <em class="markup--em markup--p-em">build.gradle</em> da app:</p><pre name="acad" id="acad" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">compile</strong> &quot;android.arch.persistence.room:runtime:1.0.0&quot;<br><strong class="markup--strong markup--pre-strong">annotationProcessor</strong> &quot;android.arch.persistence.room:compiler:1.0.0&quot;</pre><p name="48ab" id="48ab" class="graf graf--p graf-after--pre">Em seguida, temos de ter 3 classes:</p><ol class="postList"><li name="c961" id="c961" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Model (Entity)</strong>â€” neste caso iremos utilizar a classe Tarefa criada no 4Âº artigo desta sÃ©rie. A Ãºnica diferenÃ§a Ã© que vamos anotÃ¡-la para o Room.</li><li name="b3cc" id="b3cc" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">DAO (Database Access Object)</strong>â€Šâ€”â€Ša interface que irÃ¡ definir todas as queries a serem feitas na base de dados.</li><li name="e7b8" id="e7b8" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Database</strong>â€Šâ€”â€Ša classe que servirÃ¡ para conectarmos Ã  base de dados.</li></ol><p name="0395" id="0395" class="graf graf--p graf-after--li">Vamos entÃ£o comeÃ§ar pelo nosso modelo:</p><figure name="1f4a" id="1f4a" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/rosariopfernandes/9285215811676abc4b01cb92074a819a.js"></script></figure><p name="801a" id="801a" class="graf graf--p graf-after--figure">VocÃª deve ter reparado que a Ãºnica coisa nova aqui sÃ£o as anotaÃ§Ãµes:</p><ul class="postList"><li name="e5e0" id="e5e0" class="graf graf--li graf-after--p">Entity indica que a classe serÃ¡ uma tabela SQL.</li><li name="684e" id="684e" class="graf graf--li graf-after--li">PrimaryKey indica que a variÃ¡vel id serÃ¡ a chave primÃ¡ria da nossa base de dados e activamos o autoGenerate para que o id seja gerado automaticamente.</li></ul><p name="f487" id="f487" class="graf graf--p graf-after--li">EntÃ£o agora vamos criar a interface que irÃ¡ fazer o CRUD - o nosso DAO:</p><figure name="e537" id="e537" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/rosariopfernandes/da4d51524b26ab58daea4594dc478d43.js"></script></figure><p name="841a" id="841a" class="graf graf--p graf-after--figure">E mais uma vez olhamos para as anotaÃ§Ãµes:</p><ul class="postList"><li name="ca93" id="ca93" class="graf graf--li graf-after--p">Dao indica que a nossa classe irÃ¡ aceder Ã  base de dados.</li><li name="7928" id="7928" class="graf graf--li graf-after--li">Creio que Insert, Update e Delete estÃ£o claros: indicam que sÃ£o mÃ©todos de inserÃ§Ã£o, actualizaÃ§Ã£o e remoÃ§Ã£o respectivamente.</li><li name="4174" id="4174" class="graf graf--li graf-after--li">Query indicamos a query que serÃ¡ executada atravÃ©s de uma String.</li></ul><p name="f2a4" id="f2a4" class="graf graf--p graf-after--li">Em seguida criamos uma classe que herda de RoomDatabase:</p><figure name="e17f" id="e17f" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/rosariopfernandes/cf5441098ae629d26669fba171fcdcbb.js"></script></figure><p name="6844" id="6844" class="graf graf--p graf-after--figure">Por fim, para aceder aos mÃ©todos do CRUD basta criar uma variÃ¡vel da classe BaseDados, aceder Ã  TarefaDAO e chamar o mÃ©todo:</p><pre name="2874" id="2874" class="graf graf--pre graf-after--p">BaseDados db = new BaseDados.getDatabase(this);<strong class="markup--strong markup--pre-strong"><br>db</strong>.tarefaDao().criarTarefa(tarefa);</pre><p name="dc48" id="dc48" class="graf graf--p graf-after--pre">Pronto. Agora vocÃª tem uma base de dados local que reage de forma correcta Ã s mudanÃ§as do ciclo de vida.</p><p name="d48c" id="d48c" class="graf graf--p graf-after--p">E este Ã© o Ãºltimo artigo da sÃ©rie <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">Android Architecture Components</em></strong>. Espero que tenha gostado e que ela tenha sido Ãºtil para vocÃªÂ :)</p><p name="8eeb" id="8eeb" class="graf graf--p graf-after--p">O cÃ³digo-fonte completo da aplicaÃ§Ã£o de GestÃ£o de Tarefas pode ser encontrado <a href="https://github.com/rosariopfernandes/AndroidArchitectureComponents" data-href="https://github.com/rosariopfernandes/AndroidArchitectureComponents" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">neste repositÃ³rio</a>.</p><div name="291d" id="291d" class="graf graf--mixtapeEmbed graf-after--p graf--trailing"><a href="https://github.com/rosariopfernandes/AndroidArchitectureComponents" data-href="https://github.com/rosariopfernandes/AndroidArchitectureComponents" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/rosariopfernandes/AndroidArchitectureComponents"><strong class="markup--strong markup--mixtapeEmbed-strong">rosariopfernandes/AndroidArchitectureComponents</strong><br><em class="markup--em markup--mixtapeEmbed-em">AndroidArchitectureComponents - Utilizado para demonstrar a utilizaÃ§Ã£o dos Android Architecture Components (Lifecycleâ€¦</em>github.com</a><a href="https://github.com/rosariopfernandes/AndroidArchitectureComponents" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="565137eb772cfe2dc85c5a82489aac39" data-thumbnail-img-id="0*kWTP7dGaoKBOrmNU." style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*kWTP7dGaoKBOrmNU.);"></a></div></div></div></section><section name="2621" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="6afa" id="6afa" class="graf graf--p graf--leading graf--trailing">Se vocÃª tem alguma dÃºvida ou sugestÃ£o, nÃ£o hesite em me contactar pelo email <a href="mailto:rosariofernandes51@gmail.com" data-href="mailto:rosariofernandes51@gmail.com" class="markup--anchor markup--p-anchor" target="_blank">rosariofernandes51@gmail.com</a> ou pelo <a href="https://telegram.me/rosariopfernandes" data-href="https://telegram.me/rosariopfernandes" class="markup--anchor markup--p-anchor" rel="nofollow noopener nofollow noopener nofollow noopener noopener noopener noopener noopener noopener" target="_blank">Telegram</a>. Ficarei feliz por conversar com vocÃª. ğŸ™‚</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@thatfire.dev" class="p-author h-card">RosÃ¡rio Pereira Fernandes</a> on <a href="https://medium.com/p/b46de8513df8"><time class="dt-published" datetime="2017-07-03T17:01:01.523Z">July 3, 2017</time></a>.</p><p><a href="https://medium.com/@thatfire.dev/aac6-b46de8513df8" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 24, 2025.</p></footer></article></body></html>